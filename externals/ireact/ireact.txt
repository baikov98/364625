1. Лоток для использованного инструмента - это не мойка и не коробка на верхней полке.  Это отдельная прямоугольная неглубокая мисочка, куда складывается инструмент: палочки, пипетки и т. п. Картинка в аттачменте несколько неточная, тот слишком глубокий, но суть примерно та. Это небольшой неглубокий лоток прямо на столе. Чтобы не капать реактивами, пока несешь пипетку или палочку к верхней полке.
В лоток кладется всё то, что используется один раз: пипетки, не прикрепленные к банкам, стеклянные палочки для перемешивания, шпатели для набирания сыпучих веществ, пинцеты и т. п. Из лотка ничего брать нельзя. Нельзя. Даже если там что-то лежало, и туда положил чистый. 
При переходе на следующий этап лоток очищается, т. е. всё из него моется, сушится и используется снова.
2. Пипетки. Пипетки бывают двух видов: свободные и прикрепленные к крышкам банок (флаконов). Пипетка прикрепленная берется вместе с крышкой: https://5drops.ru/upload/resize_cache/iblock/165/550_500_1/shutterstock_3389057.jpg

Ее можно использовать много раз. Можно сделать, чтобы она - в виртуальном опыте - была взята уже с раствором из флакона, перенесена над пробирку/колбу, куда выливать и сама всё вылила, а потом вернулась на место. Как сейчас и реализовано. Несколько неудачно, что для того, чтобы вылить, не надо совершать никаких действий, это не соответствует реалу, но если прилипание к курсору (чтобы набирать/выливать отдельными тыцями/кликами) реализовать нельзя, то с этим приходится согласиться. 
Свободные пипетки используются в ходе опыта по одному разу и кладутся после использования в лоток. Из лотка их брать нельзя. Строго говоря, неиспользованные пипетки в жизни стоят в стаканчике, и никакого ограничения, какую пипетку для чего брать, нет. Т. е. нумеровать пипетки не обязательно: какую взял, такая и пошла в опыт. Сейчас реализован вариант, что пипетка берется, ее надо поднести к емкости с реагентом, который надо набрать (при этом внутри что-то появляется), потом НЕ ОТПУСКАЯ ее надо поднести к пробирке или колбе, куда вылить, после чего ОТПУСТИТЬ, и пипетка сама падает в лоток для использованного инструмента. Класть пипетку с набранным раствором никуда нельзя (кроме как в лоток): на полке вещество просто вытечет. 
Этот алгоритм работы пипеток имеет свои минусы (нет видимых действий по набрать и вылить), но из имеющегося лучше всего соответствует реалу. 
Еще: см. картинку со скрином. Пипетки не держат горизонтально. НИКОГДА. Их держат вертикально или с минимальным наклоном, до градусов 10 от вертикали. От этого зависит качество капли (а капля для химпипеток - такая же единица объема, как миллилитр). Поэтому то, что пипетки сделаны горизонтальными - плохо и с точки зрения химии, и с точки зрения юзабилити: по скрину видно, что угадать, куда мы льем: в какую из пробирок - непросто.
Если надо добавить 4 капли, а не одну, не надо увеличивать пробирку после каждого добавления капли, получается много мельтешения. Только после последнего.
3. Шпатель. Работает как пипетка. Банку с сыпучим веществом стоит на полке. С нее надо снять крышку. Шпатель берется из стакана, подносится к банке, на нем появляется порошок, НЕ ОТПУСКАЯ шпатель подносится к пробирке/колбе, куда высыпается, из него туда высыпается. Отпускаем, падает в лоток. Шпатель, в отличие от пипетки, держится горизонтально. 
4. Пинцет. В отличие от остального, может лежать на столе, но лучше тоже ставить в стакан. Пинцет работает аналогично шпателю (держися под углом 30-45 градусов к горизонтали) и используется аналогично шпателю. Отличие такое: если кладется что-то неактивное: железная стружка, гранула алюминия и т. п., пинцет можно было бы использовать несколько раз. Но чтобы не усложнять, можем и  здесь реализовать алгоритм: один инструмент - одно вещество - в лоток.
5. Палочка для перемешивания. Изначально желательно, чтобы палочки тоже были в стакане, и строго говоря, не имеет значения, какая палочка что перемешивает. Правило одно: перемешал - положи в лоток. Т. е. если нажал на палочку, поднес к одной пробирке, не отпуская перенес к другой - это ошибка выполнения опыта, которая фиксируется в оценках по работе. Палочка держится вертикально. Сейчас реализовано, что все палочки ставятся в пробирки, а потом все перемешиваются. А потом все убираются. Это не правильно. Палочка в колбе или пробирке - риск разбить и всё испортить (в реале).  Поэтому палочку взяли, внесли в колбу, типа перемешали, положили в лоток. 
Много чего придется описывать словами в инструкциях к работе, но если раз въезжаешь в логику, становится выполнимо. 



- Лоток для использованного инструмента - это не мойка и не коробка на верхней полке.  Это отдельная прямоугольная неглубокая мисочка, Это небольшой неглубокий лоток прямо на столе.
	Но надо поставить лоток на столе, а не на верхней полке шкафа с реактивами. И класть в него использованное оборудование.
	На следующем шаге реактивов лоток опять пуст, в него кладется новое оборудование.
- В лоток кладется всё то, что используется один раз: пипетки, не прикрепленные к банкам, стеклянные палочки для перемешивания, шпатели для набирания сыпучих веществ, пинцеты и т. п.
- Пипетка прикрепленная берется вместе с крышкой
- Если надо добавить 4 капли, а не одну, не надо увеличивать пробирку после каждого добавления капли, получается много мельтешения. Только после последнего.
	Или после каждой капли менять уровень, но увеличивать только после последней? Это
- Строго говоря, неиспользованные пипетки в жизни стоят в стаканчике, и никакого ограничения, какую пипетку для чего брать, нет. Т. е. нумеровать пипетки не обязательно: какую взял, такая и пошла в опыт.
- Может ли в стакане быть несколько шпателей? Тот же вопрос к пинцетам. Да.
- Пипетки не держат горизонтально. НИКОГДА. Их держат вертикально или с минимальным наклоном, до градусов 10 от вертикали.
- Если надо добавить 4 капли, а не одну, не надо увеличивать пробирку после каждого добавления капли, получается много мельтешения. Только после последнего.
- Банку с сыпучим веществом стоит на полке. С нее надо снять крышку.


HOWSTART:
	cmd> gulp 
	
	

1. effect => action
2. поддержка to(equip) для answer
3. для пробирки attachto
4. реагент в реакции через id
5. attachto="shelf_0|shelf_1|shelf_2|ID"
6. setup into=>attachto

7, maxDose - максимально получаемая доза
8. <reaction time= время реакции
9, если жидкость+жидкость то переливаются обе, если жидкость+осадок, то только жидкость. при переливании будет переливаться только liquid вещества
10. реакции
	<conditions>
		<equip id="pust1_f" attachto="tubes_stand"/> 
	</conditions>
11. у тебя собрался стенд + указана любая пробирка в нем через тип, а реагент давющий газ - в другой



 <setups>
	 <setup id="lab_stand">
		 <equip id="burner_block" into="stand"/>
		 <equip id="burner" into="burner_block"/>
		 <equip id="test_tube" into="stand"/>
		 <equip id="пробка_с_трубкой" into="test_tube"/>
	 </setup>
	 <setup id="lab_stand2">
		 <equip id="stand" into="stand2"/>
		 <equip id="test_tube" into="stand2"/>
	 </setup>
 </setups>
 
 <equip type="stand" attachto="stand2"></equip>
 <equip type="stand2" attachto="shelf_0" align="left"></equip>	- два типа стенда
 
 <equip type="stand" angle="100"></equip> - угол по умолчанию
 
как обозначить что продукт газ всегда выделяется по трубке?
 
первая реакция - установка 1 собрана верно, горелка активирована, на выходе - газ
вторая реакция газ (который автоматически передался во вторую пробирку) + вода = новая жидкость с эффектом газа

http://power:8088/subversion/PROSV_Resh2/trunk/HTML5/51002002






=======================================================================================


- упаковка с таблетками, должна быть надпись изменяемая (аспирин, парацетомол) если сами таблетки явно выражено отрисованы, тогда вид / возможность пустое пространство от вынутой таблетки
- Корковая пробка (как понял это пробка чтобы закрывать пробирку плотно)
- Медная проволока с петелькой на конце (судя из лаб работы, это некий инструмент, с помощью этой проволочки берется/закрепляется кусочек полимера и подносится к огню)
- еще нужно как-то таймер приобразить / дополнить. Сейчас там только 2 поля вмещается, это минуты и секунды, а согласно одной лабороторной работы нужно прождать 72 часа, т.е. еще поле для часов нужно






===================================================================
	
	
	размытость по бокам equip
		из-за overflow:hidden у wrapper canvas
		так же если делать отрицательные индексы может помочь
	
	reaction.conditions => reaction.effects ??
	вода в стакане 'sender' не бесконечна???
	если в стакан налито много воды, и добавлен перемолотый песок - реакцию не проводить?
	искры добавить если при включенном вынимается стакан?
	индикация откуда набирается в tool ? ? ?
	отсчет шпателей визуальный? но а что если чем-то другим добавили? индикация выполнения шага через граммы?
	шаги можно обмануть если каждое условие шага делать отдельно, например сахар->шпатель->ступка, очистить ступку и насыпать из банки, затем помолоть - нужна ли защита?
	если "стекло" в "стекле" то у внешнего убирать зумер? (пробирка в стакане - убирать зумер у стакана)
	в хроме возможно мутность можно убрать, если делать не transform-scale а увеливать размеры канваса через стили, после рендеринга - или помойму ничем не отличается
	в зависимости куда бросили пробирку - менять ей слот, что бы можно было перемещать в полочке для пробирок
	как идея добавить звуки к действиям, очень скрасит визуализацию (открывание пробки, льется жидкость, звук спичек и тд)
	
	touchEquip => indicator ? indicatorEquip?
	поддержка чтения xml строки объекта в самом объекте - более гибкая конфигурация ?
	detaching переименовать в touching - более подходящее по смыслу?
	dragDrop over и out (tolerance:touch) срабатывают не корректно, ощущение что drop-area меньших размеров? и оно как будто смещено вправо, если наводить пипеткой можно заметить
		во время регистрации областей в jquery отрисовать абсолютные элементы и сверить с реальными?
		проверить области которые используются в $.ui.intersect
			droparea смещена влево

	? гора https://unicode-table.com/ru/26F0/ для твердых веществ?
	
	Надо поменять область взаимодействия. Если я придвигаю кончик шпателя к банке с серой, то должно набираться, а то как-то неэстетично серединой ложки тыкать. Возможно, каждому объекту нужна «точка взаимодействия» своя. Также, мне нужно буквально совместить центры аппарата киппа с держателем, чтобы вставить трубку
		индикатор для киппа (сборок) при собирании?
	как-то все перемещается по сцене туго (частично пофиксил, сейчас со сборками проблема осталась)
	в раковину если стакан из сборки электрической перетянуть, то он зависает за раковиной, и тоже самое с переключателем
	если шаг наблюдения принудительно выйти - то не засчитается? - засчитается, но после прошествия времени
	пробирка перетаскивается за фласками, а не перед
	улетает Киппа если кинуть на горелку? потому что он еще кидается в шпатель (подумать как исправить)
	поработать над dropable area / или областью перетягивания? например там где батарея - провода занимают почти всю область - както исправить?
	перемешивание тасканием с учетом векторов? (это если эффективней перемешивается таская сверху вниз или слева направа)
	в плеере жутко тупит пробирка когда ее тягаешь, попробовать оптимизировать? (возможно из за детекта полочек?)
		возможно из-за тултипов?
		возможно из-за createjs отлавливания события мышки, Ольга занималась этой проблемой, должна была скинуть информацию как пофиксить, в профайлере хрома Performance можно увидеть что именно сжирает время такта
	стакан с электродами полупрозрачность жидкости поддержать
	при анимации увеличения в левой или нижней стороне - фона нет, поэтому анимация выглядит как-то оторвано от общей сцены - придумать решение
	если потянуть ступку за ручку то начнется анимация перемешивания
	если пипеткой набирать из закрытого флакона - "откройте крышку"
	если фласку на 2 пробирки которые рядом, а указатель на ближней, то во 2ю тоже нальется
	
	баг с drop пробирки сразу на 2их элементов (например полочка и стенд) пробирка потом не может вернуться в полочку
	если пересечение с объектом из другой полки, тогда пересечание не засчитывать
	проверить если из flaconpipette в стакан - большой уровень
	если одновременно смена цвета в пробирке + выпадение осадка - не работает
	РАбочая/расстворение - применять к каждому где size маленький и цвет отличается? (например йод)
	
	ферменты
+		проблемно градусник положить на стол, из-за большой площади пересечения по вертикале
		возможность предметы складывать на столе друг рядом с другом (стопки?) (например градусник, палочки)
		если гранулы то палочкой не набирать?
		если горелка потушена в сборке с баней, то не выводить градусы в бане? Либо выводить но только комнатные? Через какоето время они должны остыть до комнатных?
		градусник тултип с градусами ?
		градусник зумер ?
		разрешить проблему пропорций
		улучшить область водяной бани, разбить по составляющим (что бы перетягивать только за элементы бани и брать предметы "за" баней)
		уменьшить стакана видимую высоту, а то его можно тягать за пустоту сверху, это часть что используется для элетрической крышки, но в обычном стакане она не нужна
		проблема с пропорциями палочка-пробирка-стакан (увеличить стакан?)
		область срабатывания раковины сверху (градусник)
		если что-то есть в области раковины сверху, и вылить в раковину пробирку задевая это что-то, то пробирка не выльется и заглючит
		пробирки - раствор крахмала на самом дне (2мл) - позаимствовать осадок?
		кипение из бани 100С + пар (только при 100С)
		вылевание пробирки когда в ней градусник?
		reaction condition с температурой
		step condition с температурой
		
		если сначала положили индикатор в пробирку а потом налил реагент - вызывать событие индикации
		по щелчку заканчивать анимацию выливания из пробирки
		осадок -> смена цвета - нужно плавное пропадание осадка, а он резко пропадает
		
		2 раза кликнуть зум и назад, как то не плавно работает

РЭШ
	сбоку полочек можно ставить предметы
	в стенд можно положить крышку?
	банкой тяжело поподать по пробиркам, сделать что бы активной была та на которой наведена мышь
	strict
+		- выливание
		- detach (ing) ?
	иконка невозможного действия (.validate)
	пипетки с разными реакгентами можно поменять местами
+	налет, а потом осадок - налет не сбивается

	банкой может налиться 2 пробирки рядом (хотя может это плюс?)
	когда ставить пробирку назад то она попадает в какую либо пробирку и пытается туда вылиться
+	в увеличенном режиме не видно - вы успешно выполнили работу

	10-12
	анимация наклонения стакана, переливание в пробирку
	если в коде есть Blur то добавить его? Или он часто будет использоваться?
	если пробирку с реакцией в другую пробирку то что-то там ломается дальше реакции не идут
	если предмет приподнялся с полочки (спички) и положился обратно, то у него собьется zIndex согласно полочке
+	пипетка вынимается и обратно не вставляется
	проверить если не указывается from то может быть баг что из пробирки в пробирку когда по условию много пробирок за один шаг один реагент
	передин можно открыть после того как убедились что он закрыт
	
	13
	уровни для 3й реакции и цвет



===========================================================================================================
Если убрать scale 0.5 для florence_flask то перестает мутнеть другие с большим z-index
но scale нужен для анимации когда приближается и реакция иначе мутно
идея в том что бы либо всегда у него был высокий z-index
либо что бы scale применялся не всегда а только перед анимацией (? вроде уже пытался так сделать)



807200
	- гранулу натрия туда обратно из пинцета в ложку, сейчас она клонируется в ложк епосле пинцета (очищать ложку?)
	
	
	
- указывать только left если указана полка (что бы top был не обЯзателен)
	

	
	
-====================== БАГИ =============================-
Там же кнопка ответ появляется только если нажать проверить, а рамка из реактива не меняется, она к плееру относится. На Рэш это не повлияет, так как метод внутри реактива возвращает - "правильно" если его запросить (перепроверю на всякий случай)
	
51010002
	- Пипетка липнет к столу, лаба перестает работать

51003002
	- При наливании из пипетки серной кислоты, пипетка подносится к пробирке, показывается зум (типа реакция пошла), но пипетка остается прилепленной и дальше ничего не происходит.
		На этом месте останавливается и все. Браузер – эксплорер.
	- 3. не знаю, насколько важно. Пузыри в трубке идут, а в самой жидкости их нет.
	
--------------------------------------------------------------------


 	
Юлия ресурсы для Химии
	P:\IN_IMUMK-Models\!objects\design\Разработка\Реактивы\0604
	
	
	
TODO:
-------------------------------------
<condition reaction="..">
	в целом реально, если ввести настройки для хватабельных элементов, парсить условия реакции, среди условий находить необходимое и тд.
---------------------------------------

- ОПТИМИЗАЦИЯ через профайлер.
- test_tueb_gas реакция срабатывает когда реагенты добавлены но крышка не закрыта

- gastube индиктор набирания пробует брать реагенты и др. Нужно функционал навигации (стрелочка) сделать возможным не только для Tool. И гатубе наследовать от обычного оборудования, не тула??
- показ ответа клик мышки поправка на высоту оборудования, например пробирка + индикатор, щелкать не по середине а сверху индикатора
- если смена цвета в реакции, тогда анимировать можно вместе со сменой уровня (жидкость + жидкость)
- Сейчас реактивы отрабатывают так, что переключение от шага к шагу осуществляется сразу после того, как выполнились условия в шагах. Из-за этого и невнимательности проскакиваешь половину текста. Может быть сделать так, что переход к следующему шагу осуществлялся не после того, как выполнились условия в шаге, а после того, как отработали все эффекты и реакции, к которым приводят действия этого шага?
- из пробирки в пробирку - подключить анимацию переливания?
- sass css добавить префикс к картинкам
- демонстрация ответа - пробирку не в центр стенда а в свободный слот
- анимация падения чипса в пробирку сверху вниз
- если не предусмотрен toolType то не показывать индикацию набирания
- для предметов state=>status (Денис А. : пусть будет status основным)
- action="rub" (вверх вниз инструмент в емкости)
- цвет пламени горелки реагирует при наведении и отведении разрешенного equip с реагентом burn=".."
- порошок должен плавать на поверхности воды
- если лампочку последнюю в сборку, тогда она не светится
	- это если есть конфликтная реакция со сборкой которая подходит по условиям (когда тестил пустой стакан).
	- решить проблему если одинаковые реагенты, но разные сборки - реакция берется первая, это не правильно, нужно все проверять подходящие.
- в свободном режиме, тушить индикатор лучины должен через время уменьшаться
	- так же можно заменить эффект огонек уменьшается и ходит из стороны в сторону, а при остановке - снова разгорается.
- discharge пробирки починить

- демострация ответа
	- attachto=shelf_
	- mill ступка
	- таймер
	- раковина discharge=".."
	- проволка status="bottom"
- проволка ограничение в strict status="bottom" можно только если разрешено поставить
- усреднить время анимации эффектов ??
	51107002 Если не учитывать то, что одни и те же эффекты происходят разное количество времени в разных реакциях (непонятно почему), то лабу считаем выполненной полностью (пробирка 6 – выпадение осадка при добавлении медного купороса происходит крайне быстро, его практически не видно, изменение времени на time=”4” не помогло – время влияет лишь на длительность изменения цвета реакции, а осадок всё-равно вываливается мгновенно и так же быстро исчезает)
- Темное стекло надо подключить к flask – не работает
- щипцы как-то не с первого раза присоединяются 51017001
- легче на полку ложить, может инструментам добавить возможность пересекаться на полке
- цинкование пятнистость металла
- У термометра тултип остается висящим при использовании зума (51105002)
- А я прикреплю проверку на изменение реагентов, что бы как только газ пропал, лучина перестала ярко гореть. (51105002) 
- комки и волокна (51015002)
- если пробовать в процессе пробку вынимать - смотрится фигово (51002002)
- высота plaque 51008002
- если налить не в правильном порядке крахмал и глюкозу - шаг не пойдет. 51011002
- щипцы плохо убираются на полку (для инструментов уменьшить пересечение либо вообще убрать) 51017001
- мерные стаканы 50% не точно показывают ml, добавить логику для модели дом реагента
- раковину сделать объектом с запрещеным драг дроп
- полки сделать объектами со свободным позиционированием (выхватывание из полки = detaching)

- 51018002 - пропадание появление чипса - плохо смотрится, нужно как-то делать в одно мгновение либо цвет менять (но это разные чипсы по суте)
- 51013002 - спиртовку можно зажигать/тушить по желанию (по крайней мере во время шага)
- 51016002 - cork в .svg запросить у Юли
- 51104002 - spoon в .svg запросить у Юли
- 51016002 - уменьшить высоту пробирки что бы пробка нормально доставалась (тогда нужно перепроверить и перенастроить все эффекты в пробирке)
- 51104002 - если в стакан добавить воду, а потом порошок, то уровень воды должен вырасти после добавления порошка, а не во время реакции
- 51015002 - поддержка цвета комкам и волокнам
- 51105002 - можно не гасить лучину до тлеющего засунуть в пробирку, что приведет к тому что дальше не идет лаба
- 51108002 - перетягивать сначала свитч - ломается отображенеи
		- крышку всегда можно с электродами снимать (strict)
		- на последнем шаге switch можно вынимать из сборки как хочешь
		- как-то туго стакан переносится на провода
- 51015002 - если внести проволку появится индикатор, не должно быть (+ если не дождаться и вынуть, потом вообще не появляется и не набирается)
- 51016002 - условие с перепутанным оборудованием всеравно отрабатывает <condition equip="T1" from="T2"/> (шаг по растягиванию)
- 51016002 - в свободном режиме пробирка как странно может в баню вставлятся и застревать там (она присоединяется к горелке)
- 51104002 - на шаге выключить переключатель, его можно таскать из сборки
- 51016002 - можно положить каучук в обе пробирки
- 51016002 - что-то придумать с крышками, они когда хочешь вне шагов могут управляться
- 51016002 - как-то фигово анимация происходит если удерживать над щипцами, стоит что-то придумать
- палочка в пробирке - перемешать, подсказку как и со ступкой - "перемолоть"
- 51104002 переделать реагент wirew на react-width не full, react-align="center" (паралельно тест в пробирке)
- переделать трубки координаты
	return $.extend(IReact.equips.glassware.prototype.getRotation.apply(this, arguments), {
      radius: 102, // -> Math.hypot(width/zoomScale, height/zoomScale)
      baseAngle: 12.5 // -> Math.degrees(Math.tan(width/height))
    });
	width (left) - отступ слева, , плюс надо как-то позицию самой трубки учитывать относительно точки кручения (wurts_flask)
	height (top) - точка кручения, плюс надо как-то позицию самой трубки учитывать относительно точки кручения (тот же test_tube и cork_testube в стенде)
- если надета cork_gastube - значит закрыто и реагент не положить внутрь


- rename animation -> view - более правильно (.animation - old support)


------------------
online converter svg=>png
https://image.online-convert.com/convert-to-png
